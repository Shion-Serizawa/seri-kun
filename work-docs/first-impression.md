# ポートフォリオ + ブログサイト 全体設計

## 0. 設計方針（最上位）

* **目的**

  * 自分の活動・制作物・学習内容を継続的に公開する
  * 運用コストと手間を最小化する
* **思想**

  * コンテンツは基本「静的」
  * 動的要素は「必要最小限」
  * 解析は「ざっくり把握」で十分
* **制約**

  * フロントエンドは易しめ
  * コストは極力ゼロ〜低額
  * 後から拡張できる構成にする

---

## 1. サイト構成（情報設計）

### 1.1 ルーティング一覧

```
/                Home
/works           制作物一覧（1ページ完結）
/blog            ブログ一覧（タグ・年月で整理）
/blog/[slug]     ブログ記事詳細
```

### 1.2 採用しないもの

* 制作物の詳細ページ（/works/[slug] など）
* お問い合わせフォーム
* 連絡先専用ページ（SNSリンクは Home に置くのは可）

---

## 2. 各ページの役割と内容

### Home (`/`)

* 簡単な自己紹介
* 制作物サマリ（/works への導線）
* 最新ブログ記事数件
* フッターに以下を配置

  * サイト全体の累計アクセス数
  * 解析の小さい注記（Cloudflare Web Analytics / cookie-less）

---

### 制作物 (`/works`)

* **1ページ完結**
* 各制作物はカード or セクション表示
* 各制作物に含める情報（最小）

  * タイトル
  * 短い説明
  * 使用技術
  * GitHub / 公開URL（あれば）
* 詳細説明・学びの深掘りは行わない（初期段階）

---

### ブログ一覧 (`/blog`)

* 記事一覧（新しい順）
* タグによる絞り込み（※タグをカテゴリ代わりに使用）
* 年月単位でのグルーピング表示（例：2026-01）

---

### ブログ記事 (`/blog/[slug]`)

* 記事本文（Markdown）
* 表示メタ情報

  * 投稿日
  * 最終更新日
  * タグ
* 記事単位のアクセス数は表示しない（全体カウンターのみ）

---

## 3. コンテンツ管理設計

### 3.1 ブログ記事管理

* Markdown ファイルで管理
* ディレクトリ例

```
content/
  blog/
    2026-01-31-example.md
```

### 3.2 frontmatter（ブログ）

```yaml
title: "記事タイトル"
slug: "example"
publishedAt: "2026-01-31"
tags: ["kotlin", "infra"]
draft: false
description: "記事の要約"
```

### 3.3 投稿日・最終更新日の扱い（重要）

* **投稿日（publishedAt）**

  * frontmatter に手動で記述
* **最終更新日（updatedAt）**

  * CI/CD 内で Git の最終更新日時から自動生成
* 表示仕様

  * `updatedAt` が `publishedAt` と異なる場合のみ「最終更新日」を表示

👉 意味論（公開日）と機械処理（更新日）を分離し、破綻しにくい設計。

---

## 4. アクセス数カウンター設計

### 4.1 定義

* **サイト全体の累計 PV**
* ページ単位・記事単位では集計しない

### 4.2 実装概要

* ページ表示時に API を1回呼び出し
* カウンター値をインクリメント
* 保存先：KV（Key-Value ストア）

### 4.3 表示

* フッターに常時表示

```
Total Visits: XXXXX
```

---

## 5. アクセス解析（Analytics）

### 採用方針

* **最初は Cloudflare Web Analytics のみ**
* GA4 は導入しない（将来必要になったら追加可能）

### Cloudflare Web Analytics で見えるもの

* 総アクセス数
* 人気ページ
* 日 / 週 / 月の推移
* 国別アクセス
* 簡易的な流入元

### 見えないもの（＝今回は不要）

* 滞在時間
* スクロール率
* 詳細な行動分析
* Cookie 同意管理

👉 **「月1回ダッシュボードを眺める」用途に最適**

---

## 6. 技術スタック

### フロントエンド

* **Astro**

  * SSG（静的サイト生成）
  * Markdown 管理が容易
  * JavaScript をほとんど書かずに済む

### デプロイ

* **Cloudflare Pages**

  * 静的配信は無料・無制限
  * 月 500 ビルドまで無料
  * Astro 公式サポートあり

### 動的処理

* Cloudflare Pages Functions / Workers

  * アクセスカウンター用 API のみ

### 解析

* **Cloudflare Web Analytics**

---

## 7. コスト設計（現実的な見積）

| 項目        | 想定コスト      |
| --------- | ---------- |
| 静的サイト配信   | ¥0         |
| ビルド & CI  | ¥0         |
| カウンター API | ¥0（Free枠内） |
| Analytics | ¥0         |
| ドメイン      | 年間数千円のみ    |

👉 **個人利用・想定トラフィックでは課金リスクは極めて低い**

---

## 8. 拡張余地（将来）

* Kotlin バックエンドを別サービスとして追加

  * お問い合わせ
  * CMS 化
  * API 実験
* GA4 追加
* 制作物詳細ページの追加

※ すべて **既存構成を壊さずに追加可能**

---

## 9. 最終まとめ（設計の結論）

* **静的 + 最小動的 + 低コスト**
* **運用が楽で、学習を邪魔しない**
* **必要になったら拡張できる**

この設計は

> 「まず完成させる」
> 「長く使い続ける」

という点で、かなり堅い構成です。
